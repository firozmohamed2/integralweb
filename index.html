<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Firebase Google Auth</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />


    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>


    <style>
      body {
        font-family: Arial, sans-serif;
        display: flex;
        height: 100vh;
        justify-content: center;
        align-items: center;
        background: #f5f5f5;
      }
      .card {
        background: white;
        padding: 30px;
        border-radius: 8px;
        text-align: center;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      }
      button {
        padding: 12px 20px;
        font-size: 16px;
        cursor: pointer;
        margin: 5px;
      }
      textarea {
        width: 100%;
        height: 200px;
        padding: 10px;
        font-family: monospace;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin: 10px 0;
        box-sizing: border-box;
      }
      #uploadContainer {
        margin-top: 30px;
        padding-top: 30px;
        border-top: 1px solid #ddd;
      }
      img {
        border-radius: 50%;
        margin-top: 10px;
      }
    </style>
  </head>
  <body>
    <div class="card">
      <h2>Google Login</h2>


      <button id="loginBtn">Sign in with Google</button>
      <button id="logoutBtn" style="display: none">Logout</button>


      <div id="userInfo"></div>

      <div style="margin-top: 20px;">
        <a href="chapter.html"><button style="background-color: #28a745; color: white; border: none; border-radius: 4px;">Go to Chapter List</button></a>
      </div>


      <div id="uploadContainer" style="display: none">
        <h3>Upload JSON to Firestore</h3>
        <textarea
          id="jsonInput"
          placeholder="Paste your JSON here..."
        ></textarea>
        <button id="uploadBtn">Upload to Firestore</button>
        <div id="uploadStatus"></div>
      </div>
    </div>


    <script>
      // ðŸ”´ PASTE YOUR FIREBASE CONFIG HERE
      const firebaseConfig = {
        apiKey: "AIzaSyDNqfRczOHTukGdXDnuzVXjbL7P5blnyAo",
        authDomain: "dbydx-ea226.firebaseapp.com",
        projectId: "dbydx-ea226",
        storageBucket: "dbydx-ea226.firebasestorage.app",
        messagingSenderId: "329650707379",
        appId: "1:329650707379:web:18bab2bab403e1004b89c6",
        measurementId: "G-2F7YVE2X94",
      };


      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);


      const auth = firebase.auth();
      const provider = new firebase.auth.GoogleAuthProvider();
      const db = firebase.firestore();


      const loginBtn = document.getElementById("loginBtn");
      const logoutBtn = document.getElementById("logoutBtn");
      const userInfo = document.getElementById("userInfo");
      const uploadContainer = document.getElementById("uploadContainer");
      const uploadBtn = document.getElementById("uploadBtn");
      const jsonInput = document.getElementById("jsonInput");
      const uploadStatus = document.getElementById("uploadStatus");


      uploadBtn.onclick = async () => {
        const jsonText = jsonInput.value.trim();
        if (!jsonText) {
          uploadStatus.innerHTML =
            '<p style="color: red;">Please paste JSON first.</p>';
          return;
        }


        try {
          const jsonData = JSON.parse(jsonText);
          await db.collection("test").doc("v1").set(jsonData);
          uploadStatus.innerHTML =
            '<p style="color: green;">âœ“ Successfully uploaded to Firestore!</p>';
          jsonInput.value = "";
        } catch (error) {
          uploadStatus.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
        }
      };


      loginBtn.onclick = () => {
        auth.signInWithPopup(provider).catch((err) => alert(err.message));
      };


      logoutBtn.onclick = () => {
        auth.signOut();
      };


      auth.onAuthStateChanged((user) => {
        if (user) {
          loginBtn.style.display = "none";
          logoutBtn.style.display = "inline-block";
          uploadContainer.style.display = "block";


          userInfo.innerHTML = `
          <p><strong>${user.displayName}</strong></p>
          <p>${user.email}</p>
          <img src="${user.photoURL}" width="80" />
        `;
        } else {
          loginBtn.style.display = "inline-block";
          logoutBtn.style.display = "none";
          uploadContainer.style.display = "none";
          userInfo.innerHTML = "";
        }
      });
    </script>
  </body>
</html>



